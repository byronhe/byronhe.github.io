
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>SSL/TLS CipherSuite 介绍 - Tech Ideas</title>
  <meta name="author" content="byronhe">

  
  <meta name="description" content="SSL/TLS CipherSuite 介绍">
  <meta name="keywords" content="tls, crypto, protocol">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://blog.helong.info//blog/2015/01/23/ssl_tls_ciphersuite_intro/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Tech Ideas" type="application/atom+xml">
  <!--
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!--
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
-->

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-49290834-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  -->
</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Tech Ideas</a></h1>
  
    <h2>C++,Linux,Algorithm,Crypto,Lisp,etc</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="blog.helong.info/">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">SSL/TLS CipherSuite 介绍</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-01-23T14:30:00+00:00'><span class='date'>2015-01-23</span> <span class='time'>2:30 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>本文是关于SSL/TLS的 CipherSuite 的信息摘录，翻译。如有疑问，欢迎指出。</p>

<a name="L......CipherSuite........."></a>
<h2>一，CipherSuite的概念</h2>

<p>CipherSuite 这个名词目前没看到有好的中文翻译，个人觉得翻译成“加密算法套件”比较合适。Cipher泛指是密码学的加密算法，例如 aes, rsa, ecdh 等。
tls是由各类基础算法，作为原语组合而成。
一个CipherSuite是4个算法的组合：</p>

<ol>
<li>1个authentication (认证)算法</li>
<li>1个encryption(加密)算法</li>
<li>1个message authentication code (消息认证码 简称MAC)算法</li>
<li>1 个key exchange(密钥交换)算法</li>
</ol>


<!--more-->


<a name="L......CipherSuite..............."></a>
<h2>二，CipherSuite的注册管理</h2>

<p>TLS Cipher Suite  在 iana 集中注册，每一个CipherSuite分配有 一个2字节的数字用来标识 ：
可以在 iana的网页查看：
 <a href="https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-4">https://www.iana.org/assignments/tls-parameters/tls-parameters.xhtml#tls-parameters-4</a>
例如:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>0x00,0x2F    TLS_RSA_WITH_AES_128_CBC_SHA    Y   [RFC5246]
</span><span class='line'>0x00,0x30 TLS_DH_DSS_WITH_AES_128_CBC_SHA Y   [RFC5246]
</span><span class='line'>0x00,0x31 TLS_DH_RSA_WITH_AES_128_CBC_SHA Y   [RFC5246]
</span><span class='line'>0x00,0x32 TLS_DHE_DSS_WITH_AES_128_CBC_SHA    Y   [RFC5246]
</span><span class='line'>0x00,0x33 TLS_DHE_RSA_WITH_AES_128_CBC_SHA    Y   [RFC5246]
</span><span class='line'>0x00,0x34 TLS_DH_anon_WITH_AES_128_CBC_SHA    Y   [RFC5246]
</span><span class='line'>0x00,0x35 TLS_RSA_WITH_AES_256_CBC_SHA    Y   [RFC5246]
</span><span class='line'>0x00,0x36 TLS_DH_DSS_WITH_AES_256_CBC_SHA Y   [RFC5246]
</span><span class='line'>0x00,0x37 TLS_DH_RSA_WITH_AES_256_CBC_SHA Y   [RFC5246]
</span><span class='line'>0x00,0x38 TLS_DHE_DSS_WITH_AES_256_CBC_SHA    Y   [RFC5246]
</span><span class='line'>0x00,0x39 TLS_DHE_RSA_WITH_AES_256_CBC_SHA    Y   [RFC5246]
</span><span class='line'>0x00,0x3A TLS_DH_anon_WITH_AES_256_CBC_SHA    Y   [RFC5246]
</span><span class='line'>0x00,0x3B TLS_RSA_WITH_NULL_SHA256    Y   [RFC5246]
</span><span class='line'>0x00,0x3C TLS_RSA_WITH_AES_128_CBC_SHA256 Y   [RFC5246]
</span><span class='line'>0x00,0x3D TLS_RSA_WITH_AES_256_CBC_SHA256 Y   [RFC5246]
</span><span class='line'>0x00,0x3E TLS_DH_DSS_WITH_AES_128_CBC_SHA256  Y   [RFC5246]
</span><span class='line'>0x00,0x3F TLS_DH_RSA_WITH_AES_128_CBC_SHA256  Y   [RFC5246]</span></code></pre></td></tr></table></div></figure>


<p>例如其中的：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>0x00,0x37    TLS_DH_RSA_WITH_AES_256_CBC_SHA Y   [RFC5246]</span></code></pre></td></tr></table></div></figure>


<p>这一条，
0x00,0x37 这个 value 就是  TLS_DH_RSA_WITH_AES_256_CBC_SHA 这个 Cipher Suite的数字，rfc5246 定义了这个CipherSuite的具体实现。</p>

<a name="L......CipherSuite........................"></a>
<h2>三，CipherSuite在现实环境的应用</h2>

<p>tls/ssl 一共出过 5个版本：ssl2/ssl3/tls1.0/tls1.1/tls1.2 ，ssl2/ssl3这两个版本漏洞太多，请务必禁用。</p>

<p>tls1.2，当前(2015年)最新的tls协议，定义在：rfc5246</p>

<p>tls协议的实现有多种，如openssl, gnutls, nss, libressl, cyassl, polarssl, botan等等。</p>

<p>openssl的代码算是其中最混乱的，但是也是最久经考验的。
( 请参见此打脸文： <a href="http://blog.csdn.net/dog250/article/details/24552307">http://blog.csdn.net/dog250/article/details/24552307</a> )</p>

<p>个人觉得polarssl和botan的架构最清晰，代码风格清新可爱，便于学习理解协议（但是不建议在生产环境下用，例如polarssl功能尚有欠缺）。</p>

<a name="L1................"></a>
<h3>1.服务器端：</h3>

<p>说说openssl，openssl 实现了以上列表中的大部分( 摒弃了不安全的一些CipherSuite)。</p>

<p>openssl 支持的 cipher 列表，可以用  openssl  ciphers -V  | column -t 命令查看
输出如：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>0xC0,0x30  -  ECDHE-RSA-AES256-GCM-SHA384    TLSv1.2  Kx=ECDH        Au=RSA    Enc=AESGCM(256)    Mac=AEAD
</span><span class='line'>0xC0,0x2C  -  ECDHE-ECDSA-AES256-GCM-SHA384  TLSv1.2  Kx=ECDH        Au=ECDSA  Enc=AESGCM(256)    Mac=AEAD
</span><span class='line'>0xC0,0x28  -  ECDHE-RSA-AES256-SHA384        TLSv1.2  Kx=ECDH        Au=RSA    Enc=AES(256)       Mac=SHA384
</span><span class='line'>0xC0,0x24  -  ECDHE-ECDSA-AES256-SHA384      TLSv1.2  Kx=ECDH        Au=ECDSA  Enc=AES(256)       Mac=SHA384
</span><span class='line'>0xC0,0x14  -  ECDHE-RSA-AES256-SHA           SSLv3    Kx=ECDH        Au=RSA    Enc=AES(256)       Mac=SHA1
</span><span class='line'>0xC0,0x0A  -  ECDHE-ECDSA-AES256-SHA         SSLv3    Kx=ECDH        Au=ECDSA  Enc=AES(256)       Mac=SHA1
</span><span class='line'>0x00,0xA5  -  DH-DSS-AES256-GCM-SHA384       TLSv1.2  Kx=DH/DSS      Au=DH     Enc=AESGCM(256)    Mac=AEAD
</span><span class='line'>0x00,0xA1  -  DH-RSA-AES256-GCM-SHA384       TLSv1.2  Kx=DH/RSA      Au=DH     Enc=AESGCM(256)    Mac=AEAD
</span><span class='line'>0x00,0x9F  -  DHE-RSA-AES256-GCM-SHA384      TLSv1.2  Kx=DH          Au=RSA    Enc=AESGCM(256)    Mac=AEAD
</span><span class='line'>0x00,0x6B  -  DHE-RSA-AES256-SHA256          TLSv1.2  Kx=DH          Au=RSA    Enc=AES(256)       Mac=SHA256
</span><span class='line'>0x00,0x69  -  DH-RSA-AES256-SHA256           TLSv1.2  Kx=DH/RSA      Au=DH     Enc=AES(256)       Mac=SHA256
</span><span class='line'>0x00,0x68  -  DH-DSS-AES256-SHA256           TLSv1.2  Kx=DH/DSS      Au=DH     Enc=AES(256)       Mac=SHA256
</span><span class='line'>0x00,0x39  -  DHE-RSA-AES256-SHA             SSLv3    Kx=DH          Au=RSA    Enc=AES(256)       Mac=SHA1
</span><span class='line'>0x00,0x37  -  DH-RSA-AES256-SHA              SSLv3    Kx=DH/RSA      Au=DH     Enc=AES(256)       Mac=SHA1
</span></code></pre></td></tr></table></div></figure>


<p>每一行里：</p>

<ol>
<li>第1个字段是 这个CipherSuite的value，</li>
<li>第2个字段是 CipherSuite 的名字 ，</li>
<li>第3个字段是本Cipher Suite是用于哪个 SSL/TLS版本的协议，</li>
<li>第4个字段 Kx 是 key exchange 算法</li>
<li>第5个字段 Au 是 authentication 算法</li>
<li>第6个字段Enc是 encryptation算法</li>
<li>第7个字段 Mac 是 MAC 算法，用于创建消息摘要</li>
</ol>


<p>例如:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>0xC0,0x23  -  ECDHE-ECDSA-AES128-SHA256      TLSv1.2  Kx=ECDH        Au=ECDSA  Enc=AES(128)       Mac=SHA256</span></code></pre></td></tr></table></div></figure>


<p>这一行，表示：</p>

<ul>
<li> 名字为 ECDH-ECDSA-AES128-SHA256  的CipherSuite ，用于 TLSv1.2版本，</li>
<li> 使用 ECDH做密钥交换，</li>
<li> 使用ECDSA做认证，</li>
<li> 使用AES-128做加密算法，</li>
<li> 使用SHA256做MAC算法。</li>
</ul>


<p>一个CipherSuite，在 openssl 库里用这个结构体表示:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="cm">/* used to hold info on the particular ciphers used */</span>
</span><span class='line'><span class="k">struct</span> <span class="n">ssl_cipher_st</span> <span class="p">{</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">valid</span><span class="p">;</span>
</span><span class='line'>    <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>           <span class="cm">/* text name */</span>
</span><span class='line'>    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">id</span><span class="p">;</span>           <span class="cm">/* id, 4 bytes, first is version */</span>
</span><span class='line'>    <span class="cm">/*</span>
</span><span class='line'><span class="cm">     * changed in 0.9.9: these four used to be portions of a single value</span>
</span><span class='line'><span class="cm">     * &#39;algorithms&#39;</span>
</span><span class='line'><span class="cm">     */</span>
</span><span class='line'>    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">algorithm_mkey</span><span class="p">;</span> <span class="cm">/* key exchange algorithm */</span>
</span><span class='line'>    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">algorithm_auth</span><span class="p">;</span> <span class="cm">/* server authentication */</span>
</span><span class='line'>    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">algorithm_enc</span><span class="p">;</span> <span class="cm">/* symmetric encryption */</span>
</span><span class='line'>    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">algorithm_mac</span><span class="p">;</span> <span class="cm">/* symmetric authentication */</span>
</span><span class='line'>    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">algorithm_ssl</span><span class="p">;</span> <span class="cm">/* (major) protocol version */</span>
</span><span class='line'>    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">algo_strength</span><span class="p">;</span> <span class="cm">/* strength and export flags */</span>
</span><span class='line'>    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">algorithm2</span><span class="p">;</span>   <span class="cm">/* Extra flags */</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">strength_bits</span><span class="p">;</span>          <span class="cm">/* Number of bits really used */</span>
</span><span class='line'>    <span class="kt">int</span> <span class="n">alg_bits</span><span class="p">;</span>               <span class="cm">/* Number of bits for algorithm */</span>
</span><span class='line'><span class="p">};</span>
</span></code></pre></td></tr></table></div></figure>


<p>以上4个算法，对应其中的下面四行：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">algorithm_mkey</span><span class="p">;</span>   <span class="cm">/* key exchange algorithm */</span>
</span><span class='line'> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">algorithm_auth</span><span class="p">;</span>   <span class="cm">/* server authentication */</span>
</span><span class='line'> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">algorithm_enc</span><span class="p">;</span>    <span class="cm">/* symmetric encryption */</span>
</span><span class='line'> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="n">algorithm_mac</span><span class="p">;</span>    <span class="cm">/* symmetric authentication */</span>
</span></code></pre></td></tr></table></div></figure>


<a name="L2..............."></a>
<h3>2，客户端：</h3>

<p>在浏览器里面，可以这样查看当前使用的CipherSuite:
Firefox下打开gmail，点击地址栏左侧锁图标</p>

<a name="L3..............CipherSuite"></a>
<h3>3. 如何指定CipherSuite</h3>

<p>在tls中，选择CipherSuite的方法是通过cipher list</p>

<p>格式和用法见：<a href="https://www.openssl.org/docs/apps/ciphers.html">https://www.openssl.org/docs/apps/ciphers.html</a></p>

<p>nginx里面的配置项是  cipher_list</p>

<p>cipher list 的格式是：</p>

<p>一个cipher list 包含一个或者多个由冒号分隔的cipher string( 逗号和空格也可以接受但不常用)。</p>

<p>一个cipher string可以是下列形式之一:</p>

<p>(1).可以由单个cipher suite构成，例如  RC4-SHA。</p>

<p>(2).它可以表示含有某个特定算法的cipher列表，或者一种特定类型的cipher suite。例如， SHA1表示所有使用摘要算法SHA1的cipher suite, SSLV3表示所有SSL V3算法。</p>

<p>(3).cipher suite的列表,可以使用加号+ 合并到一个单一的cipher string里面。这被作为一个逻辑且操作。例如，SHA1+DES表示所有包含了 SHA，并且包含了DES的算法。</p>

<p>(4).每一个cipher string可以在前面加上字符 !,-,或者+</p>

<p>如果加了!，那么这种cipher永久从列表里面删除，就算后边显式添加进来也不行。</p>

<p>如果加了-，那么cipher中的一些或者全部可以在后面的选项里面加回来。</p>

<p>如果加了+，那么cipher被移动到列表的最后，这个选项不增加任何cipher，只是把匹配的cipher移动到最后。</p>

<p>如果没有上述字符，那么字符串被解析成一个cipher list，追加到当前配置列表的后面。如果cipher list 中的某些cipher已经存在了，就忽略该cipher。</p>

<p>(5).另外，cipher string @STRENGTH 可以用在任何点，用来把当前cipher list按照加密算法key长度排序。</p>

<p>当前建议的配置参数可以看看mozilla的这个文档：<a href="https://wiki.mozilla.org/Security/Server_Side_TLS#Recommended_configurations">https://wiki.mozilla.org/Security/Server_Side_TLS#Recommended_configurations</a></p>

<a name="L......CipherSuite.................."></a>
<h2>四，CipherSuite的进化与现状</h2>

<p>随着密码学的发展，硬件性能的提高，加密和破解的不断对抗博弈，常用的算法也在不断进化，旧的算法被破解，新的算法诞生。</p>

<p>CipherSuite的当前流行趋势：</p>

<p>authentication (认证)算法 ：常见的有 RSA/DSA/ECDSA 3种，目前最主流的是人民群众喜闻乐见，妇孺皆知的RSA ( 2048 bit及以上)， （ECDSA 是新兴趋势，例如gmail，facebook都在迁移到ECDSA，当然目前用的还不多，DSA 由于只能提供1024bit，已经没啥人敢用）。</p>

<p>加密算法：主流趋势是使用 aes，128/256 bit都可以，加密模式的趋势是使用gcm，cbc由于被发现有 BEAST 攻击等，比较难以正确使用，至于ecb模式，请勿使用。加密算法 还有RC4（不建议使用），3DES（不建议使用），Camellia(貌似日本人搞的) ，DES(已经被淘汰)等，</p>

<p>message authentication code (消息认证码 简称MAC)算法 ，主流有 sha256,sha384,sha1,等。tls中使用了HMAC模式，而不是原始的 sha256,sha1等。google已经在淘汰MD5了。（gcm是一种特殊的称为aead的加密模式，不需要配合MAC。）</p>

<p>key exchange(密钥交换)算法：主流有两种：DH和ECDH，自从斯诺登爆料了NSA的https破解方案以后，现在的 key exchange(密钥交换)算法，普遍流行 PFS，把DH, ECDH变成 DHE，ECDHE 。</p>

<p>mozilla目前推荐的 cipher list：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='cpp'><span class='line'><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="nl">SHA384</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="nl">SHA384</span><span class="p">:</span><span class="n">DHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">DHE</span><span class="o">-</span><span class="n">DSS</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="n">GCM</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">kEDH</span><span class="o">+</span><span class="nl">AESGCM</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="nl">SHA</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="nl">SHA</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="nl">SHA384</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="nl">SHA384</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="nl">SHA</span><span class="p">:</span><span class="n">ECDHE</span><span class="o">-</span><span class="n">ECDSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="nl">SHA</span><span class="p">:</span><span class="n">DHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">DHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="nl">SHA</span><span class="p">:</span><span class="n">DHE</span><span class="o">-</span><span class="n">DSS</span><span class="o">-</span><span class="n">AES128</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">DHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="nl">SHA256</span><span class="p">:</span><span class="n">DHE</span><span class="o">-</span><span class="n">DSS</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="nl">SHA</span><span class="p">:</span><span class="n">DHE</span><span class="o">-</span><span class="n">RSA</span><span class="o">-</span><span class="n">AES256</span><span class="o">-</span><span class="nl">SHA</span><span class="p">:</span><span class="o">!</span><span class="nl">aNULL</span><span class="p">:</span><span class="o">!</span><span class="nl">eNULL</span><span class="p">:</span><span class="o">!</span><span class="nl">EXPORT</span><span class="p">:</span><span class="o">!</span><span class="nl">DES</span><span class="p">:</span><span class="o">!</span><span class="nl">RC4</span><span class="p">:</span><span class="o">!</span><span class="mi">3</span><span class="nl">DES</span><span class="p">:</span><span class="o">!</span><span class="nl">MD5</span><span class="p">:</span><span class="o">!</span><span class="n">PSK</span>
</span></code></pre></td></tr></table></div></figure>


<p>mozilla的优先级选择考虑：</p>

<p>1.ECDHE+AESGCM最先选，目前没有已知漏洞。</p>

<p>2.PFS ciphersuite优先，其中ECDHE优先于DHE</p>

<p>3.SHA256优先于SHA1。完全禁用MD5。</p>

<p>4.AES 128优先于AES 256。这个问题有一些讨论。</p>

<p>5.在向后兼容模式中，AES优先于3DES。</p>

<p>6.完全禁止RC4。3DES只用于兼容老版本。</p>

<p>cloudflare的ssl cipher list配置：</p>

<p><a href="https://github.com/cloudflare/sslconfig/blob/master/conf">https://github.com/cloudflare/sslconfig/blob/master/conf</a></p>

<p>google的一篇文章解释当前cipher suite的流行趋势
<a href="http://googleonlinesecurity.blogspot.com.au/2013/11/a-roster-of-tls-cipher-suites-weaknesses.html">http://googleonlinesecurity.blogspot.com.au/2013/11/a-roster-of-tls-cipher-suites-weaknesses.html</a></p>

<p>google在密码学方面的最新进展可以在这个博客追踪：<a href="http://googleonlinesecurity.blogspot.com/">http://googleonlinesecurity.blogspot.com/</a></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">byronhe</span></span>

      




<time class='entry-date' datetime='2015-01-23T14:30:00+00:00'><span class='date'>2015-01-23</span> <span class='time'>2:30 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/crypto/'>crypto</a>, <a class='category' href='/blog/categories/tls/'>tls</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/03/27/mock-c-plus-plus-function-for-unit-test/" title="Previous Post: mock C++ function for unit test">&laquo; mock C++ function for unit test</a>
      
      
        <a class="basic-alignment right" href="/blog/2015/03/13/jump_consistent_hash/" title="Next Post: 【翻译/介绍】jump consistent hash:零内存消耗，均匀，快速，简洁，来自Google的一致性哈希算法">【翻译/介绍】jump consistent hash:零内存消耗，均匀，快速，简洁，来自Google的一致性哈希算法 &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2019/09/18/newwords_discovery/">GB 规模语料上的高性能新词发现算法</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/09/06/tls-protocol-analysis-and-crypto-protocol-design/">TLS协议分析 与 现代加密通信协议设计</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/06/05/modern-crypto/">现代密码学实践指南[2015年]</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/08/https-config-optimize-in-nginx/">Nginx下配置高性能，高安全性的https TLS服务</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/04/12/translate-Everything-you-need-to-know-about-cryptgraphy-in-1-hour/">【翻译】密码学一小时必知</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/byronhe">@byronhe</a> on GitHub
  
  <script type="text/javascript">

    //$(document).ready(function(){
    document.addEventListener("DOMContentLoaded", function(event) { 
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'byronhe',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script async src="/javascripts/github.js" type="text/javascript"> </script>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2019 - byronhe -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
    <script src="/javascripts/modernizr-2.0.js"></script>
  <!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> -->
  <script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
  <script async >!window.jQuery && document.write(unescape('%3Cscript async  src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script async  src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<!--
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
-->

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-49290834-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>





<script type="text/javascript">
      var disqus_shortname = 'byronheblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'https://blog.helong.info//blog/2015/01/23/ssl_tls_ciphersuite_intro/';
        var disqus_url = 'https://blog.helong.info//blog/2015/01/23/ssl_tls_ciphersuite_intro/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>










<script src="//s95.cnzz.com/z_stat.php?id=1256308650&web_id=1256308650" language="JavaScript"></script>

<script src="/javascripts/jquery.tableofcontents.min.js" type="text/javascript"></script>
<script src="/javascripts/toc-generator.js" type="text/javascript"></script>


  <script type="text/javascript">
  jQuery(document).ready(function() {
    // Put a TOC right before the entry content.
    generateTOC('.entry-content', 'Table of Contents');
  });
  </script>



</body>
</html>
